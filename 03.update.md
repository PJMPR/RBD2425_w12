# âœï¸ Aktualizacja danych w MongoDB

MongoDB umoÅ¼liwia aktualizowanie dokumentÃ³w za pomocÄ… metod `updateOne()`, `updateMany()` i `replaceOne()`. MoÅ¼emy aktualizowaÄ‡ tylko wybrane pola, dodawaÄ‡ nowe lub nadpisywaÄ‡ caÅ‚y dokument.

PrzykÅ‚ady odnoszÄ… siÄ™ do kolekcji `customers` i `products` ze skryptu `mongo_inserts.js`.

---

## ğŸ“Œ updateOne()

Aktualizuje **pierwszy** dokument pasujÄ…cy do zapytania.

### ğŸ”§ Zmiana kraju zamieszkania klienta z adresem e-mail â€[melissa.moore4@example.com](mailto:melissa.moore4@example.com)â€ na â€Polskaâ€

```js
db.customers.updateOne(
  { email: "melissa.moore4@example.com" },
  { $set: { "address.country": "Polska" } }
);
```

### ğŸ”§ ZwiÄ™kszenie iloÅ›ci sztuk produktu â€Mechanical Keyboardâ€ o 5

```js
db.products.updateOne(
  { name: "Mechanical Keyboard" },
  { $inc: { "inventory.quantity": 5 } }
);
```

---

## ğŸ“Œ updateMany()

Aktualizuje **wszystkie** dokumenty pasujÄ…ce do zapytania.

### ğŸ”§ Ustawienie flagi `active: false` dla wszystkich produktÃ³w o cenie powyÅ¼ej 400

```js
db.products.updateMany(
  { price: { $gt: 400 } },
  { $set: { active: false } }
);
```

---

## ğŸ“Œ replaceOne()

ZastÄ™puje **caÅ‚y dokument** nowym dokumentem.

### ğŸ”§ Zamiana dokumentu klienta o `source_id: 7` na nowy, uproszczony dokument

```js
db.customers.replaceOne(
  { source_id: 7 },
  {
    source_id: 7,
    first_name: "Natalia",
    last_name: "Szara",
    email: "natalia.szara@example.com",
    registration_date: "2025-05-28 10:00:00",
    address: {
      street: "Nowa 123",
      city: "KrakÃ³w",
      zip_code: "31-000",
      country: "Polska"
    },
    orders: []
  }
);
```

---

## ğŸ“Œ PrzykÅ‚ady z operatorem `$push` i `$pull`

### ğŸ”§ Dodanie nowego zamÃ³wienia klientowi o `source_id: 4`

```js
db.customers.updateOne(
  { source_id: 4 },
  {
    $push: {
      orders: {
        source_id: 99,
        order_date: "2025-05-28 12:00:00",
        status: "new",
        items: []
      }
    }
  }
);
```

### ğŸ”§ UsuniÄ™cie zamÃ³wieÅ„ o statusie â€cancelledâ€ u klienta `source_id: 1`

```js
db.customers.updateOne(
  { source_id: 1 },
  {
    $pull: {
      orders: { status: "cancelled" }
    }
  }
);
```

## âœ… Uwagi

* `updateOne()` i `updateMany()` wymagajÄ… podania operatorÃ³w aktualizacji (np. `$set`, `$inc`).
* `replaceOne()` wymaga peÅ‚nego nowego dokumentu â€“ pominiÄ™cie pola skutkuje jego usuniÄ™ciem.
